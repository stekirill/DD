# Описание
Этот набор callback-обработчиков управляет действиями пользователей в подписке, связанной с покупкой/продлением тарифа. В основном, они включают в себя генерацию платежей
### 1. recharge_balance

#### Назначение:

Обработчик для callback'а, который отвечает за пополнение баланса пользователя с выбором между месячным или годовым планом. Он создает уникальный платежный ID, добавляет информацию о платеже в базу данных, генерирует ссылку для оплаты и отправляет сообщение пользователю с деталями оплаты.

#### Действия:

1. Логирует начало выполнения операции пополнения.
2. Извлекает информацию о пользователе из базы данных.
3. Генерирует уникальный платежный ID.
4. Определяет тип подписки (месячная или годовая) и рассчитывает количество дней для подписки.
5. Добавляет запись о платеже в базу данных.
6. Создает ссылку для оплаты и формирует сообщение для пользователя с подробностями платежа.
7. Отправляет пользователю сообщение с ссылкой на оплату и суммой.

#### Используемые компоненты:

- **`logger`**: Для логирования действий пользователя и информации о процессе оплаты.
- **`UserDAO`**: Для получения данных о пользователе (язык и ID).
- **`PaymentDAO`**: Для добавления записи о платеже в базу данных.
- **`create_invoice`**: Функция для генерации ссылки на оплату.
- **`translations`**: Для выбора текста сообщения в зависимости от языка пользователя.(не используется сейчас)
- **`settings`**: Для получения информации о ценах планов.
### 2. recharge_balance2

#### Назначение:

Обработчик для callback'а, который выполняет пополнение баланса по аналогии с первым обработчиком, но для другого типа подписки с возможностью использования другого плана с дополнительными параметрами.

#### Действия:

1. Логирует начало выполнения операции пополнения для второго типа плана.
2. Извлекает информацию о пользователе.
3. Генерирует уникальный платежный ID.
4. Определяет тип подписки и количество дней в зависимости от выбранного плана.
5. Добавляет информацию о платеже в базу данных.
6. Создает ссылку на оплату и формирует сообщение для пользователя.
7. Отправляет пользователю сообщение с ссылкой для оплаты.

#### Используемые компоненты:

- **`logger`**: Для логирования действий и информации о процессе пополнения.
- **`UserDAO`**: Для получения данных о пользователе.
- **`PaymentDAO`**: Для сохранения данных о платеже.
- **`create_invoice`**: Для генерации платежной ссылки.
- **`translations`**: Для получения перевода сообщения на язык пользователя.
- **`settings`**: Для определения цены и характеристик плана.
### 3. recharge_balance3

#### Назначение:

Обработчик для callback'а, который управляет пополнением баланса для подписки, при этом учитывает дополнительные условия акции (например, ограничение по времени для использования скидки).

#### Действия:

1. Логирует начало выполнения операции пополнения для третьего типа плана.
2. Проверяет, прошел ли необходимый срок для использования акции.
3. Извлекает информацию о пользователе из базы данных.
4. Генерирует уникальный ID для платежа.
5. Рассчитывает стоимость и количество дней в зависимости от выбранного плана.
6. Добавляет запись о платеже в базу данных.
7. Создает ссылку на оплату и формирует сообщение с подробностями для пользователя.
8. Отправляет сообщение пользователю с ссылкой на оплату.

#### Используемые компоненты:

- **`logger`**: Для логирования действий пользователя.
- **`UserDAO`**: Для получения информации о пользователе.
- **`UserEventDAO`**: Для проверки доступности акции для пользователя.
- **`PaymentDAO`**: Для сохранения информации о платеже.
- **`create_invoice`**: Для генерации ссылки на оплату.
- **`translations`**: Для создания сообщения на языке пользователя.
- **`settings`**: Для получения цены подписки.
### 4. recharge_balance_with_free_days

#### Назначение:

Обработчик для callback'а, который управляет пополнением баланса с дополнительными бесплатными днями, предоставляемыми пользователю в рамках акции.

#### Действия:

1. Логирует начало выполнения пополнения баланса с бесплатными днями.
2. Проверяет, прошел ли необходимый срок для использования акции.
3. Извлекает информацию о пользователе из базы данных.
4. Генерирует уникальный платежный ID.
5. Определяет тип подписки и рассчитывает количество дней, включая бесплатные.
6. Добавляет запись о платеже в базу данных.
7. Создает ссылку на оплату и формирует сообщение с деталями для пользователя.
8. Отправляет сообщение пользователю с ссылкой на оплату.

#### Используемые компоненты:

- **`logger`**: Для логирования процесса пополнения.
- **`UserDAO`**: Для получения данных о пользователе.
- **`UserEventDAO`**: Для проверки, может ли пользователь воспользоваться акцией.
- **`PaymentDAO`**: Для добавления записи о платеже.
- **`create_invoice`**: Для генерации ссылки на оплату.
- **`translations`**: Для получения перевода сообщения для пользователя.
- **`settings`**: Для получения цены и характеристик плана с учетом бесплатных дней.
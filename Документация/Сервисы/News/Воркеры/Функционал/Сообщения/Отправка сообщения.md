## Общая информация

**send_message_to_user_with_media** — асинхронная функция для отправки сообщения с медиафайлом пользователю. Функция позволяет отправлять текстовое сообщение с вложением (фото, документ или видеосообщение), а также форматирует сообщение с учетом условий.

## Что принимает?

- **user_id** (int): Идентификатор пользователя, которому отправляется сообщение.
- **channel_up** (bool): Флаг, указывающий, отправляется ли сообщение от канала.
- **message_text** (str): Текст сообщения.
- **media_file_path** (str, optional): Путь к медиафайлу, который будет отправлен.
- **media_type** (str, optional): Тип медиафайла ("photo", "document", "round", "group").
- **channel_name** (str, optional): Название канала.
- **channel_link** (str, optional): Ссылка на канал.
- **send_media** (bool): Флаг, указывающий, нужно ли отправлять медиа.
- **is_foreign_agent** (bool): Флаг, указывающий, является ли сообщение от иностранного агента.
- **rubrics** (str, optional): Рубрика или категория, добавляемая к сообщению.

## Логика работы

1. Проверка на наличие ключевых слов для пользователя. Если слова не найдены, сообщение не отправляется.
2. При необходимости добавляется текст для сообщений от иностранного агента.
3. Форматирование сообщения с учетом позиции канала:
    - Если **channel_up**: Название канала будет первым.
    - Если не **channel_up**: Ссылка на канал будет внизу.
4. Если длина текста больше 1024 символов:
    - Обрезается текст, добавляется ссылка на полный текст.
5. Отправка медиа:
    - Если **send_media** и есть медиафайл:
        - **photo** — отправка фото.
        - **document** — отправка документа (включая видео).
        - **round** — отправка видеосообщения.
        - **group** — отправка группы медиафайлов.
6. В случае ошибок при отправке сообщения (например, если бот был заблокирован), происходит удаление подписки пользователя.